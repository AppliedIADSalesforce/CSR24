<html>
  <head>

    <title>UAT Enhanced Ivans Einstein Bot Test Page</title>
    <style>
      h1 {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <h1>
      Welcome to the UAT Enhanced Ivans EN Einstein Bot Chat Test Page! r2
    </h1>
    <p>Please refer to the chat button in the bottom right corner.</p>
    <div>
      <h2>Please refer to the chat button in the bottom right corner</h2>
    </div>
    <script type="text/javascript">
      const queryString = window.location.search;

      const urlParams = new URLSearchParams(queryString);

      const fName = urlParams.get("fname");
      console.log("First Name: " + fName);

      const lName = urlParams.get("lname");
      console.log("Last Name: " + lName);

      const eMail = urlParams.get("email");
      console.log("Email: " + eMail);

      function initEmbeddedMessaging() {
        try {
          window.addEventListener(
            "onEmbeddedMessagingConversationStarted",
            (event) => {
              console.log(
                "Received the onEmbeddedMessagingConversationStarted eventâ€¦"
              );
              console.log("Event detail: ", event.detail);
            }
          );
          window.addEventListener("onEmbeddedMessagingReady", () => {
            //log event
            console.log("onEmbeddedMessagingReady started");
            //set visible prechat field
            embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
              FirstName: fName,
              LastName : lName,
              email: eMail,
            });
          });
           
          embeddedservice_bootstrap.settings.language = 'en-US'; // For example, enter 'en' or 'en-US'

          embeddedservice_bootstrap.init(
				'00DO300000Ee9Nt',
				'IVANS',
				'https://appliedsystems--uat.sandbox.my.site.com/ESWIVANS1762293632126',
				{
					scrt2URL: 'https://appliedsystems--UAT.sandbox.my.salesforce-scrt.com'
				}
			);

          console.log("Chat Loaded");
        } catch (err) {
          console.error("Error loading Embedded Messaging: ", err);
        }
      }

      if (!window.embeddedservice_bootstrap) {
        var s = document.createElement("script");
        s.setAttribute(
          "src",
          "https://appliedsystems--uat.sandbox.my.site.com/ESWIVANS1762293632126/assets/js/bootstrap.min.js"
        );
        s.onload = function () {
          initEmbeddedMessaging();
        };
        document.body.appendChild(s);
      }
    </script>
  </body>
</html>
